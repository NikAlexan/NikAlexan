---
const { items = [], locale = "en" } = Astro.props;
const activeIndex = items.findIndex((item) => item.active) !== -1 ? items.findIndex((item) => item.active) : 0;
const menuTitle = locale === "ru" ? "Меню_Навигации" : "Menu_Navigation";
---

<div class="fixed inset-0 z-[100] bg-cream-bg flex flex-col overflow-hidden hidden" data-menu>
  <div class="absolute inset-0 z-0 menu-grid-bg pointer-events-none"></div>
  <div class="absolute top-6 left-6 w-4 h-4 border-l border-t border-charcoal/20 z-20"></div>
  <div class="absolute top-6 right-6 w-4 h-4 border-r border-t border-charcoal/20 z-20"></div>
  <div class="absolute bottom-6 left-6 w-4 h-4 border-l border-b border-charcoal/20 z-20"></div>
  <div class="absolute bottom-6 right-6 w-4 h-4 border-r border-b border-charcoal/20 z-20"></div>
  <header class="relative z-20 flex justify-between items-center px-8 py-6 border-b border-charcoal/5">
    <div class="font-mono text-xs tracking-[0.2em] text-charcoal/60 uppercase">
      <span class="w-2 h-2 inline-block bg-warm-amber mr-2 rounded-full animate-pulse"></span>
      {menuTitle}
    </div>
    <button
      class="w-10 h-10 border border-charcoal/10 bg-surface/40 flex items-center justify-center text-charcoal hover:bg-warm-amber hover:text-cream hover:border-warm-amber transition-all duration-300 group"
      data-menu-close
      aria-label="Close menu"
    >
      <span class="material-symbols-outlined text-xl group-hover:rotate-90 transition-transform duration-300">close</span>
    </button>
  </header>
  <div class="flex-1 flex relative z-10">
    <div class="w-14 md:w-20 border-r border-charcoal/5 flex flex-col justify-center items-center py-8 bg-charcoal-faint">
      <div class="vertical-text font-mono text-[10px] tracking-[0.3em] text-charcoal/40 whitespace-nowrap uppercase flex items-center gap-4">
        <span class="text-warm-amber font-bold">SYSTEM_MENU: ACTIVE</span>
        <span class="w-[1px] h-8 bg-charcoal/20"></span>
        <span>V.2.0.4</span>
      </div>
    </div>
    <div class="flex-1 flex flex-col justify-center px-8 md:px-16 gap-6 md:gap-8">
      <nav class="flex flex-col gap-2">
        {items.map((item, index) => (
          <a class="group block w-full" href={item.href}>
            <div class="flex items-baseline gap-4 mb-1">
              <span
                class={
                  index === activeIndex
                    ? "font-mono text-xs text-warm-amber opacity-100 transition-opacity duration-300"
                    : "font-mono text-xs text-warm-amber opacity-0 group-hover:opacity-100 transition-opacity duration-300 -translate-x-2 group-hover:translate-x-0"
                }
              >
                {String(index + 1).padStart(2, "0")}
              </span>
              <span
                class={
                  index === activeIndex
                    ? "font-mono text-4xl md:text-6xl font-bold uppercase menu-link-stroke active tracking-tighter"
                    : "font-mono text-4xl md:text-6xl font-bold uppercase menu-link-stroke tracking-tighter"
                }
              >
                {item.label}
              </span>
            </div>
            <div
              class={
                index === activeIndex
                  ? "h-[1px] w-full bg-warm-amber/20 transition-all duration-500"
                  : "h-[1px] w-0 group-hover:w-full bg-warm-amber/20 transition-all duration-500"
              }
            ></div>
          </a>
        ))}
      </nav>
    </div>
  </div>
  <div class="relative z-20 border-t border-charcoal/5 p-6 bg-surface/40 backdrop-blur-sm">
    <div class="flex flex-col gap-6">
      <div class="flex justify-between items-center">
        <div class="flex items-center gap-6">
          <div class="flex items-center bg-white border border-charcoal/10 rounded-sm p-1">
            <a
              class={
                locale === "ru"
                  ? "px-4 py-2 text-xs font-mono font-bold bg-warm-amber text-cream rounded-sm shadow-sm transition-all"
                  : "px-4 py-2 text-xs font-mono text-charcoal/60 hover:text-warm-amber transition-colors"
              }
              href="/"
            >
              RU
            </a>
            <a
              class={
                locale === "en"
                  ? "px-4 py-2 text-xs font-mono font-bold bg-warm-amber text-cream rounded-sm shadow-sm transition-all"
                  : "px-4 py-2 text-xs font-mono text-charcoal/60 hover:text-warm-amber transition-colors"
              }
              href="/en"
            >
              EN
            </a>
          </div>
          <button
            class="flex items-center gap-2 px-4 py-2.5 bg-white border border-bronze/20 rounded-sm text-bronze transition-all group"
            data-theme-toggle
          >
            <span class="material-symbols-outlined text-[16px] theme-light group-hover:text-bronze">dark_mode</span>
            <span class="material-symbols-outlined text-[16px] theme-dark group-hover:text-ochre">light_mode</span>
            <span class="font-mono text-[10px] uppercase tracking-wider hidden sm:inline-block" data-theme-label>Light</span>
          </button>
        </div>
      </div>
      <div class="flex justify-between items-end font-mono text-[9px] md:text-[10px] text-charcoal/40 uppercase tracking-wider border-t border-charcoal/5 pt-4">
        <div class="flex gap-4">
          <span>SESSION_ID: <span class="text-charcoal/80">8842-AF</span></span>
          <span class="hidden sm:inline">|</span>
          <span class="hidden sm:inline">LOC: UNKNOWN</span>
        </div>
        <div class="text-right">
          <div class="mb-1">UPTIME: <span class="text-warm-amber">99.9%</span></div>
          <div>MEM: 64MB OK</div>
        </div>
      </div>
    </div>
  </div>
</div>
